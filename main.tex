\documentclass[a4paper,12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian,english]{babel}
\usepackage[14pt]{extsizes}
\usepackage{cmap}
\usepackage{indentfirst}
\usepackage{autonum}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{upgreek}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{multirow}
\usepackage{setspace,amsmath}
\usepackage[table,xcdraw]{xcolor}
\usepackage[unicode, pdftex]{hyperref}
\usepackage[left=15mm, top=20mm, right=15mm, bottom=20mm, nohead, footskip=15mm]{geometry}
\usepackage{tikz}
\usepackage{tkz-graph}
\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\begin{document}
\selectlanguage{russian}
\setcounter{page}{0}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}

\lstset{frame=tb,
	language=C++,
	aboveskip=3mm,
	belowskip=3mm,
	showstringspaces=false,
	columns=flexible,
	basicstyle={\small\ttfamily},
	numbers=none,
	numberstyle=\tiny\color{gray},
	keywordstyle=\color{blue},
	commentstyle=\color{dkgreen},
	stringstyle=\color{mauve},
	breaklines=true,
	breakatwhitespace=true,
	tabsize=3
}

\begin{center}
	\small{Министерство науки и высшего образования Российской Федерации}\\
	\small{Федеральное государственное бюджетное образовательное учреждение}\\
	\small{Высшего образования}\\
	\small{\textbf{«Северо-Осетинский государственный университет\\
			имени Коста Левановича Хетагурова»}}\\
		
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	
	\normalsize{Курсовая работа}\\
	\large{\textbf{Транспортная задача. Методы решения.}}\\
	
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill \break
	\hfill\break
\end{center}

\begin{flushright}
	\textbf{Выполнил:}\\
	Студент 3 курса направления:\\
	«Прикладная математика и информатика»\\
	\textit{Гамосов Станислав Станиславович \underline{\hspace{3cm}}}\\
\end{flushright}

\hfill

\begin{flushright}
	\textbf{Научный руководитель:}\\
	кандидат физико-математических наук\\
	\textit{Тотиева Жанна Дмитриевна \underline{\hspace{3cm}}}\\
\end{flushright}

\hfill

\begin{flushright}
	\textbf{«Работа допустима к защите»}\\
	Заведующий кафедрой алгебры и анализа,\\
	 кандидат физико-математических наук\\
	\textit{Джусоева Нонна Анатольевна \underline{\hspace{3cm}}}\\
\end{flushright}

\normalsize{ \hspace{28pt}} \hfill \break
\begin{center} Владикавказ 2021 \end{center}

\thispagestyle{empty}
\tableofcontents
\thispagestyle{empty}
\clearpage
\newtheorem{theorem}{Теорема}

\section {Введение}
	\textbf{Транспортная задача (задача Монжа — Канторовича)} – это спектр задач с единой математической моделью, классическая формулировка, которой звучит: \textit{«Задача о наиболее экономном плане перевозок однородного продукта или взаимозаменяемых продуктов из пунктов производства в пункты потребления»}. Такая форма встречается чаще всего в линейном программирование, а если точнее в его практических приложениях. 
	
	\textbf{Линейное программирование} является одним из разделов математического программирования – области математики, разрабатывающей теорию и численные методы решения многомерных экстремальных задач с ограничениями.
	
	Проблема была впервые формализована французским математиком \textit{Гаспаром Монжем} в 1781 году. Прогресс в решении проблемы был достигнут во время Великой Отечественной войны советским математиком и экономистом \textit{Леонидом Канторовичем}. Поэтому иногда эта проблема называется \textbf{транспортной задачей Монжа — Канторовича}.
	
	Если вернуться к самой задачи огромное количество возможных вариантов перевозок затрудняет получение достаточно экономного плана эмпирическим или экспертным путем. Применение математических методов и вычислительных в планировании перевозок дает большой экономический эффект. Транспортные задачи могут быть решены \textbf{симплексным методом} однако матрица системы ограничений транспортной задачи настолько своеобразна, что для ее решения разработаны специальные методы. Они, как и \textbf{симплексный метод}, позволяют найти начальное опорное решение, а затем, улучшая его получить оптимальный результат. Транспортная задача может
	также решаться с ограничениями и без ограничений.
	
	В зависимости от способа представления условий транспортной задачи она может быть представлена в \textbf{графовой} или \textbf{матричной} форме.
	
	\clearpage
	
\section{Постановка задачи}
	
	Задача эта возникает, когда речь идет о рациональной перевозке некоторого однородного продукта от производителей к потребителям. В этом случае для каждого потребителя безразлично, откуда, из каких пунктов производства будет поступать этот продукт, лишь бы он поступал в нужном объеме. Однако от того, насколько рациональным будет прикрепление пунктов потребления к пунктам производства, существенно зависит объем транспортной работы. В связи с этим естественно возникает вопрос о наиболее эффективном прикреплении, правильном направлении перевозок груза, при котором потребности удовлетворяются, а затраты на транспортировку минимальны. Более точно задача формулируется так.
	
	Пусть имеются пункты производства $(A_1, A_2, ...,  A_n)$ с объемами производства в единицу времени, равными соответственно $(a_1, a_2, ...,  a_n)$, и пункты потребления $(B_1, B_2, ...,  B_m)$ с объемами потребления, равными $(b_1, b_2, ..., b_m)$ соответственно. Будем предполагать, что производство и потребление сбалансированы — сумма объемов производства равна сумме объемов потребления. Такой вид транспортной задачи называется \textbf{закрытым}.
	
	\[
		\sum\limits_{i=1}^n a_i = \sum\limits_{j=1}^m b_j \eqno(1)
	\]
	
	В дальнейшем будем рассматривать только такой тип задачи. Однако любую \textbf{открытую} транспортную задачу ($\sum\limits_{i=1}^n a_i \neq \sum\limits_{j=1}^m b_j$) легко закрыть. Нужно ввести дополнительный пункт производства (пункт потребления) с недостающим объемом производства (объемом потребления) и с нулевыми стоимостями перевозок.

	Предполагается, что известны величины $c_{ij}$ — затраты по перевозке единицы продукта из $i$-го пункта производства в $j$-й пункт потребления. Они могут быть выражены в стоимостной (денежной) форме или в натуральной (километрах). Требуется найти такой план перевозок, при котором были бы удовлетворены потребности в пунктах $(B_1, B_2, ...,  B_m)$ и при этом суммарные затраты на перевозку были бы минимальны. Обозначая через $x_{ij}$ количество продукта, перевозимое из $i$-го пункта производства в $j$-го пункт потребления, приходим к следующей математической формулировке задачи:
	
	\textbf{Найти минимум целевой функции}:
	
	\[
		\sum\limits_{i=1}^n \sum\limits_{j=1}^m c_{ij}x_{ij} \longrightarrow \min \eqno(2)
	\]

	\newpage
	Так же для корректности задачи необходимо соблюдать три условия:
	
	\[
		\textbf{H1.} \ \sum\limits_{i=1}^n x_{ij} = b_j; \ \ (j = \overline{1, m}) 
	\]
	
	\[
		\textbf{H2.} \ \sum\limits_{j=1}^m x_{ij} = a_i; \ \ (i = \overline{1, n})
	\]
	
	\[
		\textbf{H3.} \ x_{ij} \geqslant 0; \ \ (i = \overline{1, n}; \ \ j = \overline{1, m})
	\]

	Получается суммарные затраты на транспортировку в каждый пункт потребления завозится требуемое количество продукта, а так же из каждого пункта производства полностью вывозится произведенный продукт.
	
	Всякий набор величин $x_{ij} (i = \overline{1, n}; \ j = \overline{1, m})$, удовлетворяющих условиям $(H1-H3)$, мы будем называть допустимым планом перевозок. План, для которого суммарные затраты $(2)$ достигают минимума, называется оптимальным.
	
	\begin{equation}
		X = 
		\begin{pmatrix}
			x_{11} & x_{12} & \cdots & x_{1n} \\
			x_{21} & x_{22} & \cdots & x_{2n} \\
			\vdots  & \vdots  & \ddots & \vdots  \\
			x_{m1} & x_{m2} & \cdots & x_{mn} 
		\end{pmatrix}
	\end{equation}
	
	Условия транспортной задачи удобно представить в виде матрицы, которая имеет название \textbf{матрица перевозок}. В первой строке указаны величины потребностей, в первом столбце - значения запасов. В клетках внутренней матрицы ($m \times n$ штук) записывают стоимости перевозок и сами перевозки. Нумеровать будем только строки и столбцы внутренней матрицы.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|}
			\hline
			\multirow{2}{*}{Поставщики} & \multicolumn{6}{c|}{Потребители} & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Запасы \\ поставщика\end{tabular}} \\ \cline{2-7}
			& 1 & 2 & $\cdots$ & $j$ & $\cdots$ & $m$ &  \\ \hline
			1 & $\begin{matrix} c_{11} & \\ & x_{11} \end{matrix}$ & $\begin{matrix} c_{12} & \\ & x_{12} \end{matrix}$ & $\cdots$  & $\begin{matrix} c_{1j} & \\ & x_{1j} \end{matrix}$  & $\cdots$ & $\begin{matrix} c_{1m} & \\ & x_{1m} \end{matrix}$  & $a_1$  \\ \hline
			2 & $\begin{matrix} c_{21} & \\ & x_{21} \end{matrix}$ & $\begin{matrix} c_{22} & \\ & x_{22} \end{matrix}$  & $\cdots$ & $\begin{matrix} c_{2j} & \\ & x_{2j} \end{matrix}$  & $\cdots$ & $\begin{matrix} c_{2m} & \\ & x_{2m} \end{matrix}$  & $a_2$  \\ \hline
			$\vdots$ & $\vdots$ & $\vdots$ & $\cdots$ & $\vdots$ & $\cdots$ & $\vdots$ & $\vdots$ \\ \hline
			$i$ & $\begin{matrix} c_{i1} & \\ & x_{i1} \end{matrix}$ & $\begin{matrix} c_{i2} & \\ & x_{i2} \end{matrix}$ & $\cdots$  & $\begin{matrix} c_{ij} & \\ & x_{ij} \end{matrix}$ & $\cdots$ & $\begin{matrix} c_{im} & \\ & x_{im} \end{matrix}$ & $a_i$ \\ \hline
			$\vdots$ & $\vdots$ & $\vdots$ & $\cdots$ & $\vdots$ & $\cdots$ & $\vdots$ & $\vdots$ \\ \hline
			$n$ & $\begin{matrix} c_{n1} & \\ & x_{n1} \end{matrix}$ & $\begin{matrix} c_{n2} & \\ & x_{n2} \end{matrix}$ & $\cdots$  & $\begin{matrix} c_{nj} & \\ & x_{nj} \end{matrix}$ & $\cdots$ & $\begin{matrix} c_{nm} & \\ & x_{nm} \end{matrix}$ & $a_n$  \\ \hline
			\begin{tabular}[c]{@{}c@{}}Спрос \\ потребителя\end{tabular} & $b_1$ & $b_2$ & $\cdots$ & $b_j$ & $\cdots$ & $b_m$ & $\begin{matrix} & \sum\limits_{i=1}^n a_i \\ \sum\limits_{j=1}^m b_j & \end{matrix}$ \\ \hline
		\end{tabular}
	\end{center}

	Рассмотрим теорему о разрешимости транспортной задачи:
	
	\begin{theorem}
		Транспортная задача имеет решение, если суммарный запас груза в пунктах отправления равен суммарному спросу в пунктах назначения, т.е. если выполняется равенство (1).
	\end{theorem}
	
	\begin{proof}
		В случае превышения запаса над потребностью
		$
			\sum\limits_{i=1}^n a_i > \sum\limits_{j=1}^m b_j
		$
		как уже было обговорено выше, вводится фиктивный $(m + 1)$-ый пункт назначения с потребностью
		$
			b_{m + 1} = \sum\limits_{i = 1}^n a_i - \sum\limits_{j = 1}^m b_j
		$
		
		Соответствующие тарифы считаются равными нулю: 
		
		\[
			c_{i m+1} = 0 \ \ (i = \overline{1,m})
		\]
		
		После этих преобразований получим закрытую модель транспортной задачи.
		
		Аналогично, при
		$
			\sum\limits_{i=1}^n a_i < \sum\limits_{j=1}^m b_j
		$
		вводится фиктивный $(n+1)$ пункт отправления с грузом,
		$
			a_{n + 1} = \sum\limits_{j = 1}^m b_j - \sum\limits_{i = 1}^n a_i
		$
		а тарифы полагаются равными нулю:
		
		\[ 
			c_{n+1 j} = 0 \ \ (j = \overline{1,n})
		\]
		 
		После этих преобразований получим закрытую модель транспортной задачи.
		
		Теперь если в любом случаи мы можем свести задачу к виду 
		$
			\sum\limits_{i=1}^n a_i = \sum\limits_{j=1}^m b_j = A
		$ можем получить такие величины
		
		\[
			x_{ij} = {{a_i b_j}\over{A}}; \ \ i = \overline{1, n}; \ \ j = \overline{1,m}
		\]
		
		Исходя из выше полученного имеем решение:
		
		\[
			x_{ij} \geqslant 0
		\]
		
		Так как 
		$
		\sum\limits_{i=1}^n a_i = \sum\limits_{j=1}^m b_j = A
		$ получаем: 
		
		\[
			\sum\limits_{j=1}^m x_{ij} = \sum\limits_{j=1}^m {{a_i b_j}\over{A}} = 
			{{a_i \sum\limits_{j=1}^m b_j}\over{A}} = a_i \eqno(3)
		\]
		
		\[
			\sum\limits_{i=1}^n x_{ij} = \sum\limits_{i=1}^n {{a_i b_j}\over{A}} = 
			{{b_j \sum\limits_{i=1}^n a_i}\over{A}} = b_j \eqno(4)
		\]
		
		Следовательно, система величин $x_{ij}$, удовлетворяя всем условиям транспортной задачи, является ее решением.
	\end{proof}
	
	Так же стоит доказать еще одну теорему связанную с тем что все базисы транспортной задачи треугольные. То есть система уравнений полученная содержит по крайне мере одно уравнение с единственным неизвестным, и даже если его исключить, то опять найдется по крайней мере одно уравнение с единственной неизвестной.
	
	\begin{theorem}
		Все базисы в транспортной задаче задаются треугольной системой уравнений.
	\end{theorem}

	\begin{proof}
		Рассмотрим ячейки матрицы перевозок и пока покажем, что по крайней мере одна строка или по крайней мере один столбец содержит лишь одну базисную переменную и после удаления этой строки или этого столбца оставшийся массив сохранит это свойство.
		
		Прежде всего каждая строка и каждый столбец содержит по крайней мере одну базисную переменную. В противном случае не выполняется условие отличия от $0$ суммы по строке или по столбцу.
		
		Для массива размерностью $n \times m$, если каждая строка содержит по крайней мере две базисные переменные, то количество базисных переменных не меньше $2n$; если каждый столбец содержит по крайней мере две базисные переменные, то количество базисных переменных не меньше $2m$. Таким образом, общее количество базисных переменных не меньше $m + n$, но это невозможно, поскольку имеется всего $n + m - 1$ базисных переменных. Поэтому хотя бы одна строка или хотя бы один столбец содержат лишь одну базисную переменную.
		
		Если вычеркнуть эту строку или этот столбец, рассуждение можно повторить, а значит, описанное выше свойство выполняется для оставшегося массива, что и требовалось доказать.
	\end{proof}

	Так же стоить заметить, что если все $a_i$ или $b_j$ - целые, значения базисных переменных в допустимом базисном решении тоже целые. Поскольку это задача линейного программирования, оптимальное решение является базисным допустимым решением и, следовательно, целым. Это очень важно. Ведь тогда гарантируется, что в задачах не будет получено абсурдное решение.
	
	С учетом выше представленного задача принимает вид:
	
	\begin{equation}
		\begin{cases}
			\sum\limits_{i=1}^n \sum\limits_{j=1}^m c_{ij}x_{ij} \longrightarrow \min \\
			\sum\limits_{i=1}^n x_{ij} = a_i; \ \ i = \overline{1, n} \\
			\sum\limits_{j=1}^m x_{ij} = b_j; \ \ j = \overline{1, m} \\
			x_{ij} \geqslant 0; \ \ i = \overline{1, n}; \ \ j = \overline{1, m}
		\end{cases} \eqno(5)
	\end{equation}
	
	\textbf{Пример:}
	
	Составить математическую модель транспортной задачи перевоза груза из 3 складов в 5 магазинов. Матрица перевозок будет выглядеть так:

	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{2}{c|}{B5} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-11}
			&  & 2 &  & 7 &  & 3 &  & 6 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{70}} \\ \cline{2-11}
			&  & 9 &  & 4 &  & 5 &  & 7 &  & 3 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{50}} \\ \cline{2-11}
			&  & 5 &  & 7 &  & 6 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{60} & \multicolumn{2}{c|}{20} &  \\ \cline{1-11}
		\end{tabular}
	\end{center}

	\[
		 \sum\limits_{i=1}^3 a_{i} = 30 + 70 + 50 = 150 \ \ \ \
		 \sum\limits_{j=1}^5 b_{j} = 10 + 40 + 20 + 60 + 20 = 150 
	\]
	
	В качестве примера открытой модели давайте заменим потребность $B4$, которая равняется 60 на 40. В таком случаи нужно было бы ввести еще одного потребителя с потребностью $B6 = 20$ и с нулевыми стоимостями $c_{16} = c_{26} = c_{36} = 0$. Матрица перевозок тогда станет следующей:
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|l|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{2}{c|}{B5} & \multicolumn{2}{c|}{B6} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-13}
			&  & 2 &  & 7 &  & 3 &  & 6 &  & 2 &  & 0 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{70}} \\ \cline{2-13}
			&  & 9 &  & 4 &  & 5 &  & 7 &  & 3 &  & 0 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{50}} \\ \cline{2-13}
			&  & 5 &  & 7 &  & 6 &  & 2 &  & 4 &  & 0 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{20} &  \\ \cline{1-13}
		\end{tabular}
	\end{center}

	\clearpage

\section{Методы построения опорного плана}
	\subsection{Метод северо-западного угла}
	\begin{theorem}
		Существует план, содержащее не более чем $(m + n - 1)$ положительных перевозок $x_{ij}$. При этом система векторов соответствующая таким перевозкам $x_{ij}$, линейно независима. 
	\end{theorem}

	\begin{proof}
		Конструктивным доказательством теоремы может послужить процесс получения первого опорного плана, предложенный Данцигом и названный Чарнесом и Купером \textbf{«правилом северо-западного угла»}. Применим это правило к следующей таблице:
		
		\begin{center}
			\begin{tabular}{cccc|c}
				$x_{11}$ & $x_{12}$ & $x_{13}$ & $x_{14}$ & $a_1$ \\
				$x_{21}$ & $x_{22}$ & $x_{23}$ & $x_{24}$ & $a_2$ \\
				$x_{31}$ & $x_{32}$ & $x_{33}$ & $x_{34}$ & $a_3$ \\ \hline
				$b_1$ & $b_2$ & $b_3$ & $b_4$ & 
			\end{tabular}
		\end{center}
	
		Определим сначала значение переменной $x_{11}$, стоящей в верхнем левом углу. Пусть $x_{11} = \min(a_1,b_1)$; если $a_1 \leqslant b_1$, то $x_{11} = a_1$ и все $x_{1j} = 0$ для $j = 2,\ 3,\ 4$. Если $a_1 \geqslant b_1$, то $x_{11} = b_1$, и все $x_{i1} = 0$ для $i = 2,\ 3,\ 4$. Для определенности допустим, что справедливо первое предположение; тогда таблица преобразуется, как показано ниже в шаге 1. Здесь общее количество продукта, вывозимого из первого пункта отправления, уменьшается до нуля, а общее количество, которое необходимо подвезти к первому пункту назначения, равно $b_1 - a_1$.
		
		\textit{Шаг 1:} Пример $b_1 > a_1$
		\begin{center}
			\begin{tabular}{cccc|c}
				$x_{11} = a_1$ & $0$ & $0$ & $0$ & $0$ \\
				$x_{21}$ & $x_{22}$ & $x_{23}$ & $x_{24}$ & $a_2$ \\
				$x_{31}$ & $x_{32}$ & $x_{33}$ & $x_{34}$ & $a_3$ \\ \hline
				$b_1 - a_1$ & $b_2$ & $b_3$ & $b_4$ & 
			\end{tabular}
		\end{center}
		
		После этого определяем значение первой переменной во второй строке.  Пусть $x_{21} = \min(a_2, b_1 - a_1)$. Если допустить, что $a_2 > b_1 - a_1$, $x_{21} = b_1, - а_1$, и $х_{31} = 0$. Это показано в шаге 2. Количество продукта, которое осталось перевезти из пункта отправления 2, теперь равно $a_2 - b_1 + a_1$. В свою очередь потребность первого пункта назначения полностью удовлетворена.
		
		\textit{Шаг 2:} Допустим, что $a_2 > b_1 - a_1$.
		\begin{center}
			\begin{tabular}{cccc|c}
				$x_{11} = a_1$ & $0$ & $0$ & $0$ & $0$ \\
				$x_{21} = b_1 - a_1$ & $x_{22}$ & $x_{23}$ & $x_{24}$ & $a_2 - b_1 + a_1$ \\
				$0$ & $x_{32}$ & $x_{33}$ & $x_{34}$ & $a_3$ \\ \hline
				$0$ & $b_2$ & $b_3$ & $b_4$ & 
			\end{tabular}
		\end{center}
		
		Подобным же образом в зависимости от допущений, указанных далее, получаем следующие шаги. В каждом из них определяется значение переменной $x_i$, и сводится к нулю либо запас $і$-го пункта отправления, либо потребность $j$-го пункта назначения, или и то и другое вместе.
		
		\textit{Шаг 3:} Положим $a_2 - b_1 + a_1 > b_2$.
		\begin{center}
			\begin{tabular}{cccc|c}
				$x_{11} = a_1$ & $0$ & $0$ & $0$ & $0$ \\
				$x_{21} = b_1 - a_1$ & $x_{22} = b_2$ & $x_{23}$ & $x_{24}$ & $a_2 - b_1 + a_1 - b_2$ \\
				$0$ & $0$ & $x_{33}$ & $x_{34}$ & $a_3$ \\ \hline
				$0$ & $0$ & $b_3$ & $b_4$ & 
			\end{tabular}
		\end{center}
	
		\textit{Шаг 4:} Пусть $a_2 - b_1 + a_1 - b_2 < b_3$.
		\begin{center}
			\begin{tabular}{cccc|c}
				$x_{11} = a_1$ & $0$ & $0$ & $0$ & $0$ \\
				$x_{21} = b_1 - a_1$ & $x_{22} = b_2$ & $x_{23} = a_2 - b_1 + a_1 - b_2$ & $0$ & $0$ \\
				$0$ & $0$ & $x_{33}$ & $x_{34}$ & $a_3$ \\ \hline
				$0$ & $0$ & $b_3 - a_2 + b_1 - a_1 + b_2$ & $b_4$ & 
			\end{tabular}
		\end{center}
		
		Из шага 4 видно, что $x_{33} = b_3 - a_2 + b_1 - a_2 + b_2$ и $x_{34} = b_4$. Следует отметить, что каждая из перевозок $x_i$ была получена прибавлением и вычитанием различных комбинаций $a_i$ и $b_j$. Поэтому если  $a_i$ и $b_j$ были первоначально неотрицательными целыми числами, то и решение, получаемое в результате описанного выше процесса, будет состоять из неотрицательных целых чисел. Нетрудно видеть, что этот план может содержать самое большее $n + m - 1$ положительных перевозок. При наших предположениях относительно величин  $a_i$ и $b_j$, и допущениях, сделанных при построении плана в рассмотренном примере с тремя пунктами отправления и четырьмя пунктами назначения, положительными перевозками являются:
		
		\begin{center}
			$x_{11} = a_1; \ \ x_{21} = b_1 - a_1;$ \\
			$x_{22} = b_2; \ \ x_{23} = a_2 - b_1 + a_1 - b_2;$ \\
			$x_{33} = b_3 - a_2 + b_1 - a_1 + b_2; \ \ x_{34} = b_4;$ \\
		\end{center}
		
		Используя приведенный алгоритм построения решения, можно доказать линейную независимость системы векторов, отвечающих выписанным положительным перевозкам. Тем самым будет установлено, что построенный план является опорным решением.
	\end{proof}
	
	\textbf{Пример:}
	
	Имеется транспортная таблица с исходными данными.
	\begin{center}
		\begin{tabular}{cccccccc}
			\hline
			\multicolumn{1}{|c|}{Пункты} & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multicolumn{1}{|c|}{\multirow{2}{*}{A1}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{10}} \\ \cline{2-7}
			\multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{5} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{3} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{1} & \multicolumn{1}{c|}{} \\ \hline
			\multicolumn{1}{|c|}{\multirow{2}{*}{A2}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{20}} \\ \cline{2-7}
			\multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{3} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{2} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{4} & \multicolumn{1}{c|}{} \\ \hline
			\multicolumn{1}{|c|}{\multirow{2}{*}{A3}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-7}
			\multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{4} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{1} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{2} & \multicolumn{1}{c|}{} \\ \hline
			\multicolumn{1}{|c|}{Потребность} & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
			\multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{}
		\end{tabular}
	\end{center}
	
	Внесем в верхнюю левую клетку максимально возможного объема перевозки.
	
	\begin{center}
		\begin{tabular}{cccccccc}
			\hline
			\multicolumn{1}{|c|}{Пункты} & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multicolumn{1}{|c|}{\multirow{2}{*}{A1}} & \multicolumn{2}{c|}{\textbf{10}} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			\multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{5} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{3} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{1} & \multicolumn{1}{c|}{} \\ \hline
			\multicolumn{1}{|c|}{\multirow{2}{*}{A2}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{20}} \\ \cline{2-7}
			\multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{3} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{2} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{4} & \multicolumn{1}{c|}{} \\ \hline
			\multicolumn{1}{|c|}{\multirow{2}{*}{A3}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-7}
			\multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{4} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{1} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{2} & \multicolumn{1}{c|}{} \\ \hline
			\multicolumn{1}{|c|}{Потребность} & \multicolumn{2}{c|}{5} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
			\multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{}
		\end{tabular}
	\end{center}

	Запасы на складе $A1$ закончились, поэтому в оставшиеся ячейки данной строки ставим прочерки. Затем переходим к следующей строке и заполняем ее ячейки слева направо.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{10}} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{5}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{15}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
		\end{tabular}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{10}} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{5}} & \multicolumn{2}{c|}{\textbf{15}} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{5} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
		\end{tabular}
	\end{center}
	
	Переходим к третьей строке и тоже заполняем ее слева направо.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{10}} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{5}} & \multicolumn{2}{c|}{\textbf{15}} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{\textbf{5}} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{25}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
		\end{tabular}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{10}} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{5}} & \multicolumn{2}{c|}{\textbf{15}} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{\textbf{5}} & \multicolumn{2}{c|}{\textbf{25}} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} &  \\ \cline{1-7}
		\end{tabular}
	\end{center}

	Получено опорное решение:
	\begin{equation}
		X = 
		\begin{pmatrix}
			10 & 0 & 0 \\
			5 & 15 & 0 \\
			0 & 5 & 25 \\ 
		\end{pmatrix}
	\end{equation}
	\clearpage
	
	\subsection{Метод наименьшего элемента}
	
	Ключевая идея заключается в следующем: в таблице из всех значений стоимостей выбираем наименьшее и в клетку $(i,j)$ с наименьшей стоимостью записываем меньшее из чисел $a_i$, $b_j$. Исключаем из рассмотрения строку $і$, если запас $a_i$, вывезен полностью; или столбец $j$, если спрос $b_j$, удовлетворен полностью; или и строку и столбец, если $a_i = b_j$. Среди остальных стоимостей снова выбираем наименьшую и заполняем соответствующую клетку таблицы. Таким же образом продолжаем заполнять клетки таблицы, пока не будет найдено опорное решение. 
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{10}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{20}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
		\end{tabular}
	\end{center}

	Объемы запасов и потребностей уменьшаются на величину груза. Если запасы склада исчерпаны, то полностью вычеркиваем эту строку таблицы. Если потребности завода полностью удовлетворены — полностью вычеркиваем этот столбец таблицы.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & \textbf{1} & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{20}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
		\end{tabular}
	\end{center}

	Продолжаем в том же духе до тех пор, пока все запасы не будут исчерпаны, а все потребности удовлетворены.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{1}{c|}{\multirow{2}{*}{20}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{1}{c|}{\multirow{2}{*}{10}} \\ \cline{2-7}
			&  & 4 &  & \textbf{1} &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{25} &  \\ \cline{1-7}
		\end{tabular}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{1}{c|}{\multirow{2}{*}{20}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & \textbf{2} & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{5} &  \\ \cline{1-7}
		\end{tabular}
	\end{center}

	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{\textbf{}} & \multicolumn{1}{c|}{\multirow{2}{*}{5}} \\ \cline{2-7}
			&  & \textbf{3} &  & 2 &  & 4 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{5} &  \\ \cline{1-7}
		\end{tabular}
		\begin{tabular}{|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 5 &  & 3 &  & 1 & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{15} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{5} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 3 &  & 2 &  & \textbf{4} & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-7}
			&  & 4 &  & 1 &  & 2 & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} &  \\ \cline{1-7}
		\end{tabular}
	\end{center}

	В итоге мы получим опорный план перевозок для транспортной задачи.
	
	\begin{equation}
		X = 
		\begin{pmatrix}
			0 & 0 & 10 \\
			15 & 0 & 5 \\
			0 & 20 & 10 \\ 
		\end{pmatrix}
	\end{equation}
	\clearpage
	
\section{Вырожденность опорного плана}
	Вырожденность в транспортной задаче возникает, если одна или более базисных переменных обращаются в 0. Вырожденное решение может быть получено, если частичные суммы по столбцам равны частичным суммам по строкам. Проблему можно решить без особых трудностей. На каждом шаге следует различать базисные переменные, которые равны $0$ и стоят в соответствующих ячейках, и небазисные переменные.
	
	При построении опорного решения могут возникнуть трудности, если суммы и по строкам, и по столбцам равны между собой и обратились в $0$. В этом случае из дальнейших рассмотрений следует исключить только одну из них. Другая сумма будет ликвидирована при присвоении базисной переменной значения 0. Поскольку на каждом шаге, кроме последнего, удаляется только одна строка или только один столбец, то в результате получается $n + m - 1$ базисных переменных и столько заполненных клеток, сколько требуется (даже если некоторые базисные переменные обратились в $0$).
	
	Трудности могут возникнуть и при улучшении базисного допустимого решения. Применение правил может обратить в 0 более одной базисной переменной. В этом случае важно помнить, что только одна из них должна стать небазисной; остальные следует сохранить базисными, но с нулевыми значениями.
	
	\textbf{Пример:}
	
	Построить первоначальный план для следующей ситуации:
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{60}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{40}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{30} &  \\ \cline{1-9}
		\end{tabular}
	\end{center}

	$60 + 30 + 40 = 40 + 50 + 10 + 30$ — спрос равен предложению — задача закрытая. Методом северо — западного угла получим опорный план. Начинаем с самой верхней левой ячейки.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{60}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{40}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{30} &  \\ \cline{1-9}
		\end{tabular}
	\end{center}
	
	Потребности первого магазина выполнены полностью, но на складе еще остался груз. Заполняем дальше. Остатки груза с первого склада $60 - 40 = 20$ перевозим в магазин второй. При этом, первый склад опустел, но потребности магазина не выполнены полностью.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{60}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{40}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{30} &  \\ \cline{1-9}
		\end{tabular}
	\end{center}

	Переходим ко второму складу. Все $30$ единиц груза переносим в магазин второй, потребности которого совпали с предложением склада $50 - 20 = 30$.
	
	При данном распределении склад опустошается и потребности второго магазина выполняются полностью. Происходит потеря базисной клетки.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{1}{c|}{Запасы} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{20} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{60}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{\textbf{0}} & \multicolumn{2}{c|}{0} & \multicolumn{1}{c|}{\multirow{2}{*}{30}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{\multirow{2}{*}{40}} \\ \cline{2-9}
			&  &  &  &  &  &  &  &  & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{30} &  \\ \cline{1-9}
		\end{tabular}
	\end{center}

	В данном случае необходимо к базисным клеткам добавить клетку с нулевым значением, расположенную рядом с только что заполненной, которая обусловила потерю.
	
	С третьего склада направим $10$ единиц груза в магазин $4$ для полного выполнения его потребностей. На $3$-м складе  остается $40 - 10 = 30$ единиц груза, которые перенесем в последний магазин.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
			\hline
			Пункты & B1 &  & B2 &  & B3 &  & B4 &  & Запасы \\ \hline
			A1 & 40 &  & 20 &  & 0 &  & 0 &  & 60 \\ \hline
			&  &  &  &  &  &  &  &  &  \\ \hline
			A2 & 0 &  & 30 &  & 0 &  & 0 &  & 30 \\ \hline
			&  &  &  &  &  &  &  &  &  \\ \hline
			A3 & 0 &  & 0 &  & 10 &  & 30 &  & 40 \\ \hline
			&  &  &  &  &  &  &  &  &  \\ \hline
			Потребность & 40 &  & 50 &  & 10 &  & 30 &  &  \\ \hline
		\end{tabular}
	\end{center}

	Опорный план составлен. Количество базисных ячеек равно $6 = 3 + 4 - 1$.  Условие невырожденности выполнено.
	
	
	\clearpage
	
\section{Методы решения}
	\subsection{Метод потенциалов}
	
	Рассмотрим теорему об оптимальности решения транспортной задачи методом потенциалов.

	\[
		u_i + v_j = c_{ij}: \ \ \forall x_{ij} > 0 \eqno(6)
	\]
	\[
		u_i + v_j \leqslant c_{ij}: \ \ \forall x_{ij} = 0 \eqno(7)
	\]
	\[
		i = \overline{1, n}; \ \ j = \overline{1, m}
	\]

	Немного перепишем исходную задачу и введем пару новых понятий
	
	\begin{center}
		$u_i$ \ ($i = \overline{1,n}$) - оценка единицы запаса (потенциал поставщика) \\
		$v_j$ \ ($j = \overline{1,m}$) - оценка единицы спроса (потенциал потребителя)
	\end{center}
	
	Тогда задача примет вид:
	\[
		X = \sum\limits_{i = 1}^n a_i u_i + \sum\limits_{j = 1}^m b_j v_j \longrightarrow\max
	\]
	при ограничениях
	
	\begin{center}
		$u_i + v_j \leqslant c_{ij} \ \ (i = \overline{1,n}) \ \ (j = \overline{1,m})$ \\
		$u_i (i = \overline{1,n}); \ \ v_j (j = \overline{1,m})$ - произвольного знака
	\end{center}

	\textbf{Алгоритм решения}

	\begin{enumerate} 
		\item Находится первый опорный план по одному из рассмотренных методов.
		\item Проверяется найденный опорный план на оптимальность, для чего:
		\begin{enumerate} 
			\item Находятся потенциалы поставщиков $u_i (i = \overline{1,n})$ и потребителей $v_j (j = \overline{1,m})$ по формуле (6).
			
			\textit{\textbf{Примечание}: Так как в опорном плане заполнено $n + m - 1$ клеток таблицы транспортной задачи, то для нахождения потенциалов по данному плану можно составить систему из $n + m - 1$ линейно независимых уравнений с $n + m$ неизвестными. Такая система является неопределенной, и поэтому одной неизвестной (обычно $u_1$) придают нулевое значение, а остальные находятся однозначно по формуле (6).}
			 
			\item Проверяется, выполнено ли условие (7) или, что то же самое, условие $s_{ij} = c_{ij} - (u_i + v_j) \geqslant 0$, где $s_{ij}$, - характеристика каждой свободной ячейки матрицы. Если для всех свободных 7ячеек матрицы условие (7) выполнено, т.e. $s_{ij} \geqslant 0$, то опорный план транспортной задачи является оптимальным (решение задачи завершено). Если же для некоторых свободных клеток таблицы $s_{ij} < 0$, то клетка с наименьшим значением $s_{ij}$, является перспективной, и выполняется следующий пункт алгоритма.
			
			\item К перспективной ячейке строится цикл, расставляются знаки по циклу, при этом в перспективную ячейку ставится плюс, а остальные знаки в вершинах цикла чередуются, и определяется величина перераспределения груза по формуле $Q = \min x_{ij}$, где $x_{ij}$ - объем перевозки груза, записанный в клетках (вершинах) цикла таблицы, отмеченных знаком минус.
			
			\item Осуществляется перераспределение груза по циклу на величину $Q$. В результате выполнения этого пункта будет получен новый опорный план, который проверяется на оптимальность, т.е. производится переход к пункту 2.1 алгоритма.
		\end{enumerate}
	\end{enumerate}
	
	\textbf{Пример:} 
	
	Три завода производят однородную продукцию в количестве 650, 850 и 700 единиц соответственно. Эта продукция требуется четырем потребителям в количествах 500, 800, 300 и 600 единиц каждому. Затраты на перевозку единицы продукции (тыс. руб. ) от каждого завода к каждому потребителю заданы матрицей:
	
	\[
		\begin{pmatrix}
			30 & 50 & 62 & 10 \\
			40 & 50 & 80 & 20 \\
			50 & 10 & 30 & 30 \\
		\end{pmatrix}
	\]
	
	Требуется спланировать перевозку груза так, чтобы суммарные транспортные затраты были минимальными.
	
	Занесем данные транспортной задач и найдем опорный план перевозок продукции методом минимальной стоимости. Найденный план является невырожденным, так как в таблице заполнено ровно $m + n - 1 = 3 + 4 - 1 = 6$ клеток. Затраты на перевозку продукции для данного плана равны:
	
	\[
		X = 1 \ 500 + 6 \ 000 + 18 \ 000 + 5 \ 000 + 24 \ 000 + 7 \ 000 = 61 \ 500
	\]
	
	Применяя далее алгоритм решения задачи, находим потенциалы поставщиков и потребителей. Полагая $u_1 = 0$, определяем, что $v_1 = 30$, так как $u_1 + v_1 = 30$, и из соотношения $u_1 + v_4 = 10$ находим $v_4 = 10$. Аналогично найдены все другие потенциалы.
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|cc}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{1}{c|}{Запасы} & \multicolumn{1}{c|}{$u_i$} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{62} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{650}} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-9}
			&  & 50 &  &  &  &  &  &  & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{80} & \multicolumn{2}{c|}{20} & \multicolumn{1}{c|}{\multirow{2}{*}{850}} & \multicolumn{1}{c|}{\multirow{2}{*}{10}} \\ \cline{2-9}
			&  & 450 & \textbf{$\oplus$} & 100 & \textbf{$\ominus$} & 300 &  &  & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{30} & \multicolumn{1}{c|}{\multirow{2}{*}{700}} & \multicolumn{1}{c|}{\multirow{2}{*}{-30}} \\ \cline{2-9}
			&  &  & \textbf{$\ominus$} & 700 & \textbf{$\oplus$} &  &  &  & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{500} & \multicolumn{2}{c|}{800} & \multicolumn{2}{c|}{300} & \multicolumn{2}{c|}{600} & \multicolumn{1}{c|}{$\begin{matrix}
					& 2200 \\
					2200 & \\
				\end{matrix}$} &  \\ \cline{1-10}
			$v_j$ & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{70} & \multicolumn{2}{c|}{10} &  &  \\ \cline{1-9}
		\end{tabular}
	\end{center}
	
	Найдем характеристики свободных клеток таблицы транспортной задачи по формуле
	
	\[
		s_{ij} = c_{ij} - (u_i + v_j) 
	\]
	\[
		s_{12} = 50 - (0 + 40) = 10, \ \ \ \ s_{13} = 62 - (0 + 70) = -8,
	\]
	\[
		s_{24} = 20 - (10 + 10) = 0, \ \ \ \ s_{31} = 50 - (30 - 30) = 50,
	\]
	\[
		s_{33} = 30 - (-30 + 70) = -10, \ \ \ \ s_{34} = 30 - (-30 + 10) = 50.
	\]
	
	Так как $s_{13} < 0$ и $s_{33} < 0$, то план неоптимальный, и перспективной ячейкой в ней будет ячейка (3, 3) с наименьшей характеристикой $s_{33} = - 10$. 
	
	Строим цикл к перспективной клетке и находим величину перераспределения груза $Q = \min(300, 700) = 300$.
	
	Осуществляем перераспределение груза по циклу, добавляя величину $Q = 300$ в клетках со знаком $«+»$ и вычитая - в клетках со знаком $«-»$. В результате получаем новый опорный план.
	
	Применяя правило пункта 2 алгоритма к полученному плану транспортной задачи, убеждаемся, что он оптимальный, так как для всех свободных клеток таблицы $s_{ij} \geqslant 0$. Суммарные минимальные затраты на перевозку продукции:
	
	\[
		Z_{\min} = 61 \ 500 - 10 \cdot 300 = 58 \ 500
	\]
	
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|cc}
			\hline
			Пункты & \multicolumn{2}{c|}{B1} & \multicolumn{2}{c|}{B2} & \multicolumn{2}{c|}{B3} & \multicolumn{2}{c|}{B4} & \multicolumn{1}{c|}{Запасы} & \multicolumn{1}{c|}{$u_i$} \\ \hline
			\multirow{2}{*}{A1} & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{62} & \multicolumn{2}{c|}{10} & \multicolumn{1}{c|}{\multirow{2}{*}{650}} & \multicolumn{1}{c|}{\multirow{2}{*}{0}} \\ \cline{2-9}
			&  & 50 &  &  &  &  &  & 600 & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A2} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{80} & \multicolumn{2}{c|}{20} & \multicolumn{1}{c|}{\multirow{2}{*}{850}} & \multicolumn{1}{c|}{\multirow{2}{*}{10}} \\ \cline{2-9}
			&  & 450 &  & 400 &  &  &  &  & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \hline
			\multirow{2}{*}{A3} & \multicolumn{2}{c|}{50} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{30} & \multicolumn{1}{c|}{\multirow{2}{*}{700}} & \multicolumn{1}{c|}{\multirow{2}{*}{-30}} \\ \cline{2-9}
			&  &  &  & 400 &  & 300 &  &  & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \hline
			Потребность & \multicolumn{2}{c|}{500} & \multicolumn{2}{c|}{800} & \multicolumn{2}{c|}{300} & \multicolumn{2}{c|}{600} & \multicolumn{1}{c|}{$\begin{matrix}
					& 2200 \\
					2200 & \\
				\end{matrix}$} &  \\ \cline{1-10}
			$v_j$ & \multicolumn{2}{c|}{30} & \multicolumn{2}{c|}{40} & \multicolumn{2}{c|}{70} & \multicolumn{2}{c|}{10} &  &  \\ \cline{1-9}
		\end{tabular}
	\end{center}
	
	Эти минимальные затраты достигаются при следующих объемах:
	
	\[
		x_{11} = 50, \ \ \ x_{14} = 600, \ \ \ x_{21} = 450,
	\]
	\[
		x_{22} = 400, \ \ \ x_{32} = 400, \ \ \ x_{33} = 300.
	\]
	
	Остальные неизвестные оставляем равны нулю.
	\clearpage

	\subsection{Решение с помощью теории графов}
	
	В этом разделе рассмотрен алгоритм решения транспортной задачи при помощи теории графов и потоков. Методы представленные ниже подходят для решения гораздо большего класса задач, однако они эффективно справляются и с ранее поставленной проблемой. Прежде чем переходить на прямою к алгоритму, который решает транспортную задачу стоить рассмотреть пару дополнительных определений и теорем.
	
	\textbf{Транспортные сети и потоки}
	
	\textbf{Транспортная сеть} $G = (V, E)$ представляет собой ориентированный граф, в котором каждое ребро $(u, v) \in E$ имеет неотрицательную \textbf{ пропускную способность} $c(u,v) \geqslant 0$. Далее мы потребуем, чтобы в случае, если $Е$ содержит ребро $(u,v)$, обратного ребра $(v,u)$ не было (вскоре мы	увидим, как обойти это ограничение). Если $(u,v) \notin E$, то для удобства определим $c(u,v) = 0$, а также запретим петли. В транспортной сети выделяются две вершины: \textbf{исток} s и \textbf{сток} t. Для удобства предполагается, что каждая вершина лежит на неком пути от истока к стоку, т.е. для любой вер	шины $v \in V$ транспортная сеть содержит путь $s \longrightarrow v \longrightarrow t$. Таким образом, граф является связным и, поскольку каждая вершина, отличная от $s$, содержит как минимум одно входящее ребро, $|E| > |V| - 1$. Рис. 1 показан пример транспортной сети.


	\begin{figure}[!h]
		\begin{tikzpicture}[-latex, node distance=2cm, align=center, line width=1pt]
			\tikzstyle{Vertex} = [circle, fill=black!10]
			
			\node[Vertex](s) at (0, 2) {$s$};
			
			\node[Vertex](v2) at (2, 0) {$v_{2}$};
			\node[Vertex](v4) at (6, 0) {$v_{4}$};
			
			\node[Vertex](v1) at (2, 4) {$v_{1}$};
			\node[Vertex](v3) at (6, 4) {$v_{3}$};
			
			\node[Vertex](t) at (8, 2) {$t$};
			
			\Edge[label = 16](s)(v1);
			\Edge[label = 13](s)(v2);
			\Edge[label = 4](v2)(v1);
			\Edge[label = 12](v1)(v3);
			\Edge[label = 14](v2)(v4);
			\Edge[label = 9](v3)(v2);
			\Edge[label = 7](v4)(v3);
			\Edge[label = 4](v4)(t);
			\Edge[label = 20](v3)(t);
		\end{tikzpicture}
		\begin{tikzpicture}[-latex, node distance=2cm, align=center, line width=1pt]
			\tikzstyle{Vertex} = [circle, fill=black!10]
			
			\node[Vertex](s) at (0, 2) {$s$};
			
			\node[Vertex](v2) at (2, 0) {$v_{2}$};
			\node[Vertex](v4) at (6, 0) {$v_{4}$};
			
			\node[Vertex](v1) at (2, 4) {$v_{1}$};
			\node[Vertex](v3) at (6, 4) {$v_{3}$};
			
			\node[Vertex](t) at (8, 2) {$t$};
			
			\Edge[label = 11/16](s)(v1);
			\Edge[label = 8/13](s)(v2);
			\Edge[label = 1/4](v2)(v1);
			\Edge[label = 12/12](v1)(v3);
			\Edge[label = 11/14](v2)(v4);
			\Edge[label = 4/9](v3)(v2);
			\Edge[label = 7/7](v4)(v3);
			\Edge[label = 4/4](v4)(t);
			\Edge[label = 15/20](v3)(t);
		\end{tikzpicture}
		\caption{Транспортная сеть и Поток в транспортной сети}
	\end{figure}

	Транспортная сеть $G = (V, E)$ для задачи о грузовых перевозках компании. Истоком $s$ является фабрика откуда груз поступает, а стоком $t$ - склад, куда груз направляется. Продукты доставляются через промежуточные пункты, но за день из города $u$ в город $v$ можно отправить только $с(u, v)$ товара. На рисунке указана пропускная способность каждого ребра сети. 
	
	Поток $f$ в транспортной сети $G$ со значением $|f| = 19$. Каждое ребро $(u, v)$ имеет метку $f(u,v)/c(u,v)$ (\textit{косая черта используется только для того, чтобы отделить поток от пропускной способности, и не обозначает деление}).
	
	Теперь можно дать более формальное определение потоков. Пусть $G = (V, E)$ - транспортная сеть с функцией пропускной способности $c$. Пусть $c$ является истоком, a $t$ - стоком. \textbf{Потоком} в $G$ является действительная функция $f: V \times V \rightarrow R$, удовлетворяющая следующим двум условиям:
	
	\textbf{Ограничение пропускной способности}. 
	
	\[
		\forall u, v \in V \text{: \ } 0 \leqslant f(u,v) \leqslant c(u,v)
	\]
	
	\textbf{Сохранение потока}. 
	
	\[
		\forall u \in V - \{s, t\} \text{: \ }
		\sum\limits_{v \in V} f(v,u) = \sum\limits_{v \in V} f(u,v)
	\]
	
	Когда $(u, v) \notin E$, поток из $u$ в $v$ быть не может, так что $f(u,v) = 0$.
	
	Неотрицательную величину $f(u, v)$ мы называем потоком из вершины $u$ в вершину $v$. \textbf{Величина} $|f|$ потока $f$ определяется как:
	\[
		|f| = \sum\limits_{v \in V} f(s, v) - \sum\limits_{v \in V} f(v, s) \eqno(8)
	\]

	т.е. как суммарный поток, выходящий из истока, минус входящий в него. (Здесь	запись $|\cdot|$ означает величину потока, а не абсолютное значение или мощность. Обычно транспортная сеть не имеет ребер, входящих в исток, и поток в исток, задаваемый суммой $f(v, s)$, равен $0$. Однако мы включаем его, поскольку позже в этой главе при рассмотрении остаточных сетей потоки в исток станут  важными. В задаче о \textbf{максимальном потоке} дана некоторая транспортная сеть G с истоком s и стоком t, и необходимо найти поток максимальной величины.
	
	\textbf{Остаточной пропускной способностью} ребра $(u,v)$ называется величина дополнительного потока, который мы можем направить из $u$ в $v$, не превысив пропускную способность $c(u,v)$. Иными словами:
	
	\[
		c_f(u,v) = \begin{cases}
			c(u, v) - f(u, v) & \text{если $(u,v) \in E$}\\
			f(v, u) & \text{если $(v,u) \in E$}\\
			0 & \text{в противном случае}\\
		\end{cases}
		\eqno(9)
	\]
	
	\begin{figure}[!h]
		\begin{tikzpicture}[-latex, node distance=2cm, align=center, line width=1pt]
			\tikzstyle{Vertex} = [circle, fill=black!10]
			
			\node[Vertex](s) at (0, 2) {$s$};
			
			\node[Vertex](v1) at (4, 4) {$v_1$};
			\node[Vertex](v2) at (4, 0) {$v_2$};
			
			\node[Vertex](t) at (8, 2) {$t$};
		
			\Edge[label = 3/4](s)(v1)
			\Edge[label = 2/5](s)(v2)
			\Edge[label = 2/2](v1)(v2)
			\Edge[label = 1/2](v1)(t)
			\Edge[label = 4/6](v2)(t)
		\end{tikzpicture}\ \ \
		\begin{tikzpicture}[-latex, node distance=2cm, align=center, line width=1pt, bend left = 18]
			\tikzstyle{Vertex} = [circle, fill=black!10]
			
			\node[Vertex](s) at (0, 2) {$s$};
			
			\node[Vertex](v1) at (4, 4) {$v_1$};
			\node[Vertex](v2) at (4, 0) {$v_2$};
			
			\node[Vertex](t) at (8, 2) {$t$};
			
			\Edge[label = 1](s)(v1)
			\Edge[label = 3](s)(v2)
			\Edge[label = 0](v1)(v2)
			\Edge[label = 1](v1)(t)
			\Edge[label = 2](v2)(t)
			
			\Edge[label = 3](v1)(s)
			\Edge[label = 2](v2)(s)
			\Edge[label = 2](v2)(v1)
			\Edge[label = 1](t)(v1)
			\Edge[label = 4](t)(v2)
		\end{tikzpicture}
		\caption{Граф с некоторым потоком и Остаточная сеть этого графа}
	\end{figure}
	
	\textbf{Увеличивающие пути}
	
	Для заданных транспортной сети $G = (V, E)$ и потока $f$ \textbf{увеличивающим путем} $р$ является простой путь из $s$ в $t$ в остаточной сети $G_f$. Coгласно определению остаточной сети мы можем увеличить поток в ребре $(u, v)$ увеличивающего пути до $c_f(u, v)$ без нарушения ограничения пропускной способности соответствующего ребра в исходной сети.
	
	Максимальная величина, на которую можно увеличить поток в каждом ребре увеличивающего пути р, называется остаточной пропускной способностью пути $р$ и задается формулой
	\[
		C_f(p) = min \ \{c_f(u, v) : (u, v) \ \text{принадлежит} \ \ p\}
	\]
	
	\textbf{Транспортная сеть с несколькими истоками и стоками}
	
	В задаче о максимальном потоке может быть несколько истоков и стоков. Например, у компании может быть $m$ фабрик $\{s_{1}, s_{2}, \dots, s_{m}\}$ и $n$ складов $\{t_{1},t_{2}, \dots, t_{n}\}$, как показано ниже, где приведен пример транспортной сети с пятью истоками и тремя стоками. К счастью, эта задача не сложнее, чем обычная задача о максимальном потоке.
	
	\begin{figure}[!h]
		\begin{tikzpicture}[-latex, node distance=2cm, align=center, line width=1pt]
			\tikzstyle{Vertex} = [circle, fill=black!10]
			
			\node[Vertex](s1) at (0, 8) {$s_{1}$};
			\node[Vertex](s2) at (0, 6) {$s_{2}$};
			\node[Vertex](s3) at (0, 4) {$s_{3}$};
			\node[Vertex](s4) at (0, 2) {$s_{4}$};
			\node[Vertex](s5) at (0, 0) {$s_{5}$};
			
			\node[Vertex](v1) at (2, 7) {$ \ $};
			\node[Vertex](v2) at (2, 5) {$ \ $};
			\node[Vertex](v3) at (2, 3) {$ \ $};
			\node[Vertex](v4) at (2, 1) {$ \ $};
			
			\node[Vertex](t1) at (4, 6) {$t_{1}$};
			\node[Vertex](t2) at (4, 4) {$t_{2}$};
			\node[Vertex](t3) at (4, 2) {$t_{3}$};
			
			\Edge[label = 10](s1)(v1)
			\Edge[label = 12](s2)(v1)
			\Edge[label = 5](s2)(v2)
			\Edge[label = 8](s3)(v2)
			\Edge[label = 14](s3)(v3)
			\Edge[label = 7](s4)(v3)
			\Edge[label = 11](s4)(v4)
			\Edge[label = 2](s5)(v4)
			
			\Edge[label = 3](v1)(t1)
			\Edge[label = 15](v2)(t1)
			\Edge[label = 6](v2)(t2)
			\Edge[label = 20](v3)(t2)
			\Edge[label = 13](v3)(t3)
			\Edge[label = 18](v4)(t3)
		\end{tikzpicture}\ \ \
		\begin{tikzpicture}[-latex, node distance=2cm, align=center, line width=1pt]
			\tikzstyle{Vertex} = [circle, fill=black!10]
			
			\node[Vertex](s) at (-1, 4) {$s$};
			
			\node[Vertex](s1) at (2, 8) {$s_{1}$};
			\node[Vertex](s2) at (2, 6) {$s_{2}$};
			\node[Vertex](s3) at (2, 4) {$s_{3}$};
			\node[Vertex](s4) at (2, 2) {$s_{4}$};
			\node[Vertex](s5) at (2, 0) {$s_{5}$};
			
			\node[Vertex](v1) at (5, 7) {$ \ $};
			\node[Vertex](v2) at (5, 5) {$ \ $};
			\node[Vertex](v3) at (5, 3) {$ \ $};
			\node[Vertex](v4) at (5, 1) {$ \ $};
			
			\node[Vertex](t1) at (8, 6) {$t_{1}$};
			\node[Vertex](t2) at (8, 4) {$t_{2}$};
			\node[Vertex](t3) at (8, 2) {$t_{3}$};
			
			\node[Vertex](t) at (11, 4) {$t$};
			
			\Edge[label = $\infty$](s)(s1)
			\Edge[label = $\infty$](s)(s2)
			\Edge[label = $\infty$](s)(s3)
			\Edge[label = $\infty$](s)(s4)
			\Edge[label = $\infty$](s)(s5)
			
			\Edge[label = 10](s1)(v1)
			\Edge[label = 12](s2)(v1)
			\Edge[label = 5](s2)(v2)
			\Edge[label = 8](s3)(v2)
			\Edge[label = 14](s3)(v3)
			\Edge[label = 7](s4)(v3)
			\Edge[label = 11](s4)(v4)
			\Edge[label = 2](s5)(v4)
			
			\Edge[label = 3](v1)(t1)
			\Edge[label = 15](v2)(t1)
			\Edge[label = 6](v2)(t2)
			\Edge[label = 20](v3)(t2)
			\Edge[label = 13](v3)(t3)
			\Edge[label = 18](v4)(t3)
			
			\Edge[label = $\infty$](t1)(t)
			\Edge[label = $\infty$](t2)(t)
			\Edge[label = $\infty$](t3)(t)
		\end{tikzpicture}
		\caption{Добавление фиктивных вершин}
	\end{figure}

	Преобразование задачи о максимальном потоке с несколькими истоками и стоками в задачу с одним истоком и одним стоком. Слева транспортная сеть с пятью истоками $S = \{ s_1, s_2, s_3, s_4, s_5 \}$ и тремя стоками $T = \{ t_1, t_2, t_3 \}$. Справа эквивалентная сеть с одним истоком и одним стоком. Мы добавляем фиктивный исток $s$ и ребра с бесконечной пропускной способностью от до каждого из исходных истоков. Кроме того, мы добавляем фиктивный сток $t$ и ребра с бесконечной пропускной способностью из каждого из исходных истоков в $t$. 
	
	Задача определения максимального потока в сети с несколькими истоками и несколькими стоками сводится к обычной задаче о максимальном потоке. Выше показано, как сеть с несколькими стоками и истоками, можно превратить в обычную транспортную сеть с одним истоком и одним стоком. Для этого в сеть добавляются \textbf{фиктивный исток} $s$ и ориентированные ребра $(s, s_i)$ с пропускной способностью $с(s, s_i) = \infty$ для каждого $ i = \overline{1,m}$. Точно так же создается \textbf{фиктивный сток} $t$ и добавляются ориентированные ребра $(t_i, t)$ c $c(t_i,t) = \infty$ для каждого $і = \overline{1, n}$.
	
	Интуитивно понятно, что любой поток в сети слева соответствует потоку в сети справа, и наоборот. Единственный исток $s$ просто обеспечивает поток любой требуемой величины к истокам $s_i$, а единственный сток $t$ аналогичным образом потребляет поток любой желаемой величины от множественных стоков $t_i$.
	
	\textbf{Метод Форда-Фалкерсона}
	
	\textbf{Идея}
	
	Метод Форда Фалкерсона итеративно увеличивает значение потока. Вначале поток обнуляется: $f(u,v) = 0$ для всех $u, v \in V$. Затем величина потока итеративно увеличивается посредством поиска увеличивающего пути (путь от источника $s$ к стоку $t$, вдоль которого можно послать ненулевой поток). В стандартном алгоритме, осуществляющий этот поиск с помощью обхода в глубину (DFS). Процесс повторяется, пока можно найти увеличивающий путь.
	
	\textbf{Реализация}
	
	\begin{lstlisting}
	int bfs(int s, int t){
		Q.push(s);
		while( !mark[t] && !Q.empty() ){
			int u = Q.front(); Q.pop();
			for(int v = 1; v < N; v++)
			if( !mark[v] && (C[u][v] - F[u][v] > 0) ){
				push[v] = min(push[u], C[u][v] - F[u][v]);
				mark[v] = 1;
				pred[v] = u;
				Q.push(v);
			}
		}	
		return mark[t];
	}
	\end{lstlisting}

	\textbf{Оценка производительности}
	
	Добавляя поток увеличивающего пути к уже имеющемуся потоку, максимальный поток будет получен, когда нельзя будет найти увеличивающий путь. Тем не менее, если величина пропускной способности — иррациональное число, то алгоритм может работать бесконечно. В целых числах таких проблем не возникает и время работы ограничено $O(|E|f)$, где $E$ — число рёбер в графе, $f$ — максимальный поток в графе, так как каждый увеличивающий путь может быть найден за $O(E)$ и увеличивает поток как минимум на $1$.
	
	\textbf{Поток минимальной стоимости}
	
	Пусть дана сеть $G(V,E)$. $s,t \in V$ — источник и сток. Ребра $(u,v) \in E$ имееют пропускную способность $c(u,v)$, поток $f(u,v)$ и цену за единицу потока $a(u,v)$. \textbf{Тогда общая стоимость потока} из $s$ в $t$:
	
	\[
		p(u,v) = \sum\limits_{u,v \in V, \ f(u,v) > 0} a(u,v) \cdot f(u,v)
	\]
	
	Дана сеть $G(V,E)$. $s,t \in V$ — источник и сток. Ребра $(u,v) \in E$ имееют пропускную способность $c(u,v)$, поток $f(u,v)$ — и цену за единицу потока $a(u,v)$. Требуется найти максимальный поток, суммарная стоимость которого минимальна.
	
	
	\clearpage
	
\section{Заключение}
	В работе изложены основные подходы и методы решения транспортной задачи, являющейся одной из наиболее распространенных задач линейного программирования. 
	
	Решение данной задачи позволяет разработать наиболее рациональные пути и способы транспортирования товаров, устранить чрезмерно дальние, встречные, повторные перевозки. Все это сокращает время продвижения товаров, уменьшает затраты предприятий и фирм, связанные с осуществлением процессов снабжения сырьем, материалами, топливом, оборудованием и т.д.
	
	Алгоритм и методы решения транспортной задачи могут быть использованы при решении некоторых экономических задач, не имеющих ничего общего с транспортировкой груза. В этом случае величины тарифов $c_{ij}$ имеют различный смысл в зависимости от конкретной экономической задачи. К таким задачам относятся следующие: оптимальное закрепление за станками операций по обработке деталей. В них $c_{ij}$ является таким экономическим показателем, как производительность. Задача позволяет определить, сколько времени и на какой операции нужно использовать каждый из станков, чтобы обработать максимальное количество деталей. Так как транспортная задача требует нахождения минимума, то значения $c_{ij}$ берутся с отрицательным знаком; оптимальные назначения, или проблема выбора. Уменьшение порожнего пробега сократит количество автомобилей для перевозок, увеличив их производительность; решение задач с помощью метода запрещения перевозок. Используется в том случае, если груз от некоторого поставщика по каким-то причинам не может быть отправлен одному из потребителей. Данное ограничение можно учесть, присвоив соответствующей клетке достаточно большое значение стоимости, тем самым в эту клетку не будут производиться перевозки. 
	
	Таким образом, важность решения данной задачи несомненна.
	
	\clearpage
	
\begin{thebibliography}{99}
	\addcontentsline{toc}{section}{Список литературы}
	\bibitem{1}
	Юдин Д.Б., Гольштейн Е.Г. Задачи и методы линейного программирования;
	Москва: Советское радио, 1969 - 736с.
	\bibitem{2}
	Канторович Л.В., Горстко А.Б. Математическое оптимальное программирование  в экономике;
	Москва: Знание, 1968 - 96с.
	\bibitem{3}
	Палий И.А., Линейное программирование. Учебное пособие;
	Москва: Эксмо, 2008 - 256с.
	\bibitem{4} 
	Костевич Л.C. Математическое программирование. Информационные технологии оптимальных решений;
	Минск: Новое знание, 2003 - 424c.
	\bibitem{5}
	Акулич И.Л. Математическое программирование в примерах и задачах; Санкт-Петербург: Лань, 2011 - 352с.
	\bibitem{6}
	Данциг Д. Линейное программирование, его обобщения и применения; Москва: Прогресс, 1966 - 602с.
	\bibitem{7}
	Гасс С. Линейное программирование; Москва: Физматгиз, 1961 - 303с.
	\bibitem{8}
	Томас Х. Кормен, Чарльз И. Лейзерсон, Рональд Л. Ривест, Клиффорд Штайн. Алгоритмы: построение и анализ, 3-е издание; Москва: «Вильямс», 2013. - 1328 с.
\end{thebibliography}

\end{document} 